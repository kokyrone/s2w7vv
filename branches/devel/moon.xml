<?xml version="1.0" encoding="utf-8"?>
<includes>
	<include name="Moon">
		<!-- Assume bonus to effects is symmetrical around New Moon or Full Moon -->
		<if advanced = '"%MOON" == "New Moon"'>
			<var name="MoonPhase">0</var>
		</if>
		<!-- Check for Waxing Moon -->
		<elseif advanced = '"%MOON == "Waxing Crescent"'>
			<!-- If %MOONPCT < 24% we know it's Early, rather than Late -->
			<if advanced = "%MOONPCT &lt; 24">
				<var name="MoonPhase">1</var>
			</if>
			<else>
				<var name="MoonPhase">2</var>
			</else>
		</elseif>
		<elseif advanced = '"%MOON" == "First Quarter*"'>
			<var name="MoonPhase">3</var>
		</elseif>
		<elseif advanced = '"%MOON == "Waxing Gibbous"'>
			<!-- If %MOONPCT < 74% we know it's Early, rather than Late -->
			<if advanced = "%MOONPCT &gt; 73">
				<var name="MoonPhase">4</var>
			</if>
			<else>
				<var name="MoonPhase">5</var>
			</else>
		</elseif>
		<elseif advanced = '"%MOON" == "Full Moon"'>
			<var name="MoonPhase">6</var>
		</elseif>
		<!-- Check for Waning Moon -->
		<elseif advanced = '"%MOON == "Waning Gibbous"'>
			<!-- If %MOONPCT > 76% we know it's Early, rather than Late -->
			<if advanced = "%MOONPCT &gt; 76">
				<!-- Actually Phase 7 in Full Cycle -->
				<var name="MoonPhase">5</var>
			</if>
			<else>
				<!-- Actually Phase 8 in Full Cycle -->
				<var name="MoonPhase">4</var>
			</else>
		</elseif>
		<elseif advanced = '"%MOON" == "Last Quarter*"'>
			<!-- Actually Phase 9 in Full Cycle -->
			<var name="MoonPhase">3</var>
		</elseif>
		<else advanced = '"%MOON == "*Waning Crescent"'>
			<!-- If %MOONPCT > 26% we know it's Early, rather than Late -->
			<if advanced = "%MOONPCT &gt; 26">
				<!-- Actually Phase 10 in Full Cycle -->
				<var name="MoonPhase">2</var>
			</if>
			<else>
				<!-- Actually Phase 11 in Full Cycle -->
				<var name="MoonPhase">1</var>
			</else>
		</else>
	</include>
</includes>
<!-- vim: set ts=4 ff=unix : -->
